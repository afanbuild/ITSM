
/********************************************************
* Generated By:   zhumc

* Date Generated: 2007年10月4日
* ******************************************************/
using System;
using System.Data;
using System.Data.OracleClient;
using Epower.DevBase.BaseTools;
using Epower.ITSM.Base;
using Epower.DevBase.Organization.SqlDAL;
using Epower.DevBase.Organization.Base;

namespace Epower.ITSM.SqlDAL
{
    /// <summary>
    /// 
    /// </summary>
    public class Equ_DeskDefineItemDP
    {
        /// <summary>
        /// 
        /// </summary>
        public Equ_DeskDefineItemDP()
        { }

        #region Property
        #region ID
        /// <summary>
        ///
        /// </summary>
        private Decimal mID;
        public Decimal ID
        {
            get { return mID; }
            set { mID = value; }
        }
        #endregion

        #region ContractID
        /// <summary>
        ///
        /// </summary>
        private Decimal mContractID;
        public Decimal ContractID
        {
            get { return mContractID; }
            set { mContractID = value; }
        }
        #endregion

        #region Name
        /// <summary>
        ///
        /// </summary>
        private String mName;
        public String Name
        {
            get { return mName; }
            set { mName = value; }
        }
        #endregion

        #region ItemName
        /// <summary>
        ///
        /// </summary>
        private String mItemName;
        public String ItemName
        {
            get { return mItemName; }
            set { mItemName = value; }
        }
        #endregion

        #region Deleted
        /// <summary>
        ///
        /// </summary>
        private Int32 mDeleted;
        public Int32 Deleted
        {
            get { return mDeleted; }
            set { mDeleted = value; }
        }
        #endregion

        #endregion

        #region GetReCorded
        /// <summary>
        /// 
        /// </summary>
        /// <param name="lngID"></param>
        /// <returns>Equ_DeskDefineItemDP</returns>
        public Equ_DeskDefineItemDP GetReCorded(long lngID)
        {
            Equ_DeskDefineItemDP ee = new Equ_DeskDefineItemDP();
            string strSQL = string.Empty;
            OracleConnection cn = ConfigTool.GetConnection();
            strSQL = "SELECT * FROM Equ_DeskDefineItem WHERE ID = " + lngID.ToString();
            DataTable dt = OracleDbHelper.ExecuteDataTable(cn, CommandType.Text, strSQL);
            ConfigTool.CloseConnection(cn);
            foreach (DataRow dr in dt.Rows)
            {
                ee.ID = Decimal.Parse(dr["ID"].ToString());
                ee.ContractID = Decimal.Parse(dr["ContractID"].ToString());
                ee.Name = dr["Name"].ToString();
                ee.ItemName = dr["ItemName"].ToString();
                ee.Deleted = Int32.Parse(dr["Deleted"].ToString());
            }
            return ee;
        }
        #endregion

        #region GetDataTable
        /// <summary>
        /// 
        /// </summary>
        /// <param name="sWhere"></param>
        /// <param name="sOrder"></param>
        /// <returns>DataTable</returns>
        public DataTable GetDataTable(string sWhere, string sOrder)
        {
            string strSQL = string.Empty;
            OracleConnection cn = ConfigTool.GetConnection();
            strSQL = "SELECT * FROM Equ_DeskDefineItem Where 1=1 And Deleted=0 ";
            strSQL += sWhere;
            strSQL += sOrder;
            DataTable dt = OracleDbHelper.ExecuteDataTable(cn, CommandType.Text, strSQL);
            ConfigTool.CloseConnection(cn);
            return dt;
        }
        #endregion


        #region InsertRecorded
        /// <summary>
        /// 
        /// </summary>
        /// <param name=pEqu_DeskDefineItemDP></param>
        public void InsertRecorded(Equ_DeskDefineItemDP pEqu_DeskDefineItemDP)
        {
            OracleConnection cn = ConfigTool.GetConnection();
            string strSQL = string.Empty;
            string strID = "0";
            try
            {
                strID = EpowerGlobal.EPGlobal.GetNextID("Equ_DeskDefineItemID").ToString();
                pEqu_DeskDefineItemDP.ID = decimal.Parse(strID);
                strSQL = @"INSERT INTO Equ_DeskDefineItem(
									ID,
									ContractID,
									Name,
									ItemName,
									Deleted
					)
					VALUES( " +
                            strID.ToString() + "," +
                            pEqu_DeskDefineItemDP.ContractID.ToString() + "," +
                            StringTool.SqlQ(pEqu_DeskDefineItemDP.Name) + "," +
                            StringTool.SqlQ(pEqu_DeskDefineItemDP.ItemName) + "," +
                            pEqu_DeskDefineItemDP.Deleted.ToString() +
                    ")";

                OracleDbHelper.ExecuteNonQuery(cn, CommandType.Text, strSQL);
            }
            catch
            {
                throw;
            }
            finally
            {
                ConfigTool.CloseConnection(cn);
            }
        }
        #endregion

        #region UpdateRecorded
        /// <summary>
        /// 
        /// </summary>
        /// <param name=pEqu_DeskDefineItemDP></param>
        public void UpdateRecorded(Equ_DeskDefineItemDP pEqu_DeskDefineItemDP)
        {
            OracleConnection cn = ConfigTool.GetConnection();
            string strSQL = string.Empty;
            try
            {
                strSQL = @"UPDATE Equ_DeskDefineItem Set " +
                                                        " ContractID = " + pEqu_DeskDefineItemDP.ContractID.ToString() + "," +
                            " Name = " + StringTool.SqlQ(pEqu_DeskDefineItemDP.Name) + "," +
                            " ItemName = " + StringTool.SqlQ(pEqu_DeskDefineItemDP.ItemName) + "," +
                            " Deleted = " + pEqu_DeskDefineItemDP.Deleted.ToString() +
                                " WHERE ID = " + pEqu_DeskDefineItemDP.ID.ToString();

                OracleDbHelper.ExecuteNonQuery(cn, CommandType.Text, strSQL);
            }
            catch
            {
                throw;
            }
            finally
            {
                ConfigTool.CloseConnection(cn);
            }
        }
        #endregion

        #region DeleteRecorded
        /// <summary>
        /// 
        /// </summary>
        /// <param name="lngID"></param>
        public void DeleteRecorded(long lngID)
        {
            OracleConnection cn = ConfigTool.GetConnection();
            try
            {
                string strSQL = "Update Equ_DeskDefineItem Set Deleted=1  WHERE ID =" + lngID.ToString();
                OracleDbHelper.ExecuteNonQuery(cn, CommandType.Text, strSQL);
            }
            catch
            {
                throw;
            }
            finally
            {
                ConfigTool.CloseConnection(cn);
            }
        }
        #endregion

        #region 巡检时加载项目数据
        /// <summary>
        /// 
        /// </summary>
        /// <param name="sArr"></param>
        /// <returns></returns>
        public static DataTable GetEquItem(string sArr)
        {
            string sWhere = string.Empty;
            string[] arr = sArr.Split(',');
            if (arr.Length > 1)
                sWhere += " and ID In(";
            for (int i = 0; i < arr.Length - 1; i++)
            {
                if (i != arr.Length - 2)
                    sWhere += arr[i] + ",";
                else
                    sWhere += arr[i] + ")";
            }
            string strSQL = @"select to_number(0) PatrolID,
									to_number(0) FlowID,
									ContractID EquID,
									Name EquName,
									ID ItemID,
									ItemName ItemName,
									0 ItemData,
									sysdate PatrolTime,
									'' PatrolName,
									'' Remark"
                + " from Equ_DeskDefineItem where 1=1 ";
            strSQL += sWhere;
            OracleConnection cn = ConfigTool.GetConnection();
            try
            {
                DataTable dt = OracleDbHelper.ExecuteDataTable(cn, CommandType.Text, strSQL);
                return dt;
            }
            catch (Exception e)
            {
                throw e;
            }
            finally
            {
                ConfigTool.CloseConnection(cn);
            }
        }
        #endregion 

        #region 计划时加载项目数据
        /// <summary>
        /// 
        /// </summary>
        /// <param name="sArr"></param>
        /// <returns></returns>
        public static DataTable GetPlanEquItem(string sArr)
        {
            string sWhere = string.Empty;
            string[] arr = sArr.Split(',');
            if (arr.Length > 1)
                sWhere += " and ID In(";
            for (int i = 0; i < arr.Length - 1; i++)
            {
                if (i != arr.Length - 2)
                    sWhere += arr[i] + ",";
                else
                    sWhere += arr[i] + ")";
            }
            string strSQL = @"select ID,
                                    to_number(0) PlanID,
									'' PlanName,
									ContractID EquID,
									Name EquName,
									ID ItemID,
									ItemName ItemName "
                + " from Equ_DeskDefineItem where 1=1 ";
            strSQL += sWhere;
            OracleConnection cn = ConfigTool.GetConnection();
            try
            {
                DataTable dt = OracleDbHelper.ExecuteDataTable(cn, CommandType.Text, strSQL);
                return dt;
            }
            catch (Exception e)
            {
                throw e;
            }
            finally
            {
                ConfigTool.CloseConnection(cn);
            }
        }
        #endregion 
    }
}

