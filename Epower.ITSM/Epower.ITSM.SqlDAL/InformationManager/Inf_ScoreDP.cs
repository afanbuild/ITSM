/********************************************************
* Generated By:   zhumc

* Date Generated: 2007Äê9ÔÂ26ÈÕ
* ******************************************************/
using System;
using System.Data;
using System.Data.OracleClient;
using Epower.DevBase.BaseTools;
using Epower.ITSM.Base;
using Epower.DevBase.Organization.SqlDAL;
using Epower.DevBase.Organization.Base;

namespace Epower.ITSM.SqlDAL
{
    /// <summary>
    /// 
    /// </summary>
    public class Inf_ScoreDP
    {
        /// <summary>
        /// 
        /// </summary>
        public Inf_ScoreDP()
        { }

        #region Property
        #region ID
        /// <summary>
        ///
        /// </summary>
        private Decimal mID;
        public Decimal ID
        {
            get { return mID; }
            set { mID = value; }
        }
        #endregion

        #region KBID
        /// <summary>
        ///
        /// </summary>
        private Decimal mKBID;
        public Decimal KBID
        {
            get { return mKBID; }
            set { mKBID = value; }
        }
        #endregion

        #region UserID
        /// <summary>
        ///
        /// </summary>
        private Decimal mUserID;
        public Decimal UserID
        {
            get { return mUserID; }
            set { mUserID = value; }
        }
        #endregion

        #region UserName
        /// <summary>
        ///
        /// </summary>
        private String mUserName;
        public String UserName
        {
            get { return mUserName; }
            set { mUserName = value; }
        }
        #endregion

        #region Score
        /// <summary>
        ///
        /// </summary>
        private Int32 mScore;
        public Int32 Score
        {
            get { return mScore; }
            set { mScore = value; }
        }
        #endregion

        #region RegTime
        /// <summary>
        ///
        /// </summary>
        private DateTime mRegTime;
        public DateTime RegTime
        {
            get { return mRegTime; }
            set { mRegTime = value; }
        }
        #endregion

        #endregion

        #region GetReCorded
        /// <summary>
        /// 
        /// </summary>
        /// <param name="lngID"></param>
        /// <returns>Inf_ScoreDP</returns>
        public Inf_ScoreDP GetReCorded(long lngID)
        {
            Inf_ScoreDP ee = new Inf_ScoreDP();
            string strSQL = string.Empty;
            OracleConnection cn = ConfigTool.GetConnection();
            strSQL = "SELECT * FROM Inf_Score WHERE ID = " + lngID.ToString();
            DataTable dt = OracleDbHelper.ExecuteDataTable(cn, CommandType.Text, strSQL);
            ConfigTool.CloseConnection(cn);
            foreach (DataRow dr in dt.Rows)
            {
                ee.ID = Decimal.Parse(dr["ID"].ToString());
                ee.KBID = Decimal.Parse(dr["KBID"].ToString());
                ee.UserID = Decimal.Parse(dr["UserID"].ToString());
                ee.UserName = dr["UserName"].ToString();
                ee.Score = Int32.Parse(dr["Score"].ToString());
                ee.RegTime = DateTime.Parse(dr["RegTime"].ToString());
            }
            return ee;

        }
        #endregion

        #region GetDataTable
        /// <summary>
        /// 
        /// </summary>
        /// <param name="sWhere"></param>
        /// <param name="sOrder"></param>
        /// <returns>DataTable</returns>
        public DataTable GetDataTable(string sWhere, string sOrder)
        {
            string strSQL = string.Empty;
            OracleConnection cn = ConfigTool.GetConnection();
            strSQL = "SELECT * FROM Inf_Score Where 1=1 ";
            strSQL += sWhere;
            strSQL += sOrder;
            DataTable dt = OracleDbHelper.ExecuteDataTable(cn, CommandType.Text, strSQL);
            ConfigTool.CloseConnection(cn);
            return dt;
        }
        #endregion


        #region InsertRecorded
        /// <summary>
        /// 
        /// </summary>
        /// <param name=pInf_ScoreDP></param>
        public void InsertRecorded(Inf_ScoreDP pInf_ScoreDP)
        {
            OracleConnection cn = ConfigTool.GetConnection();
            string strSQL = string.Empty;
            try
            {
                string strNextID = EpowerGlobal.EPGlobal.GetNextID("Inf_ScoreID").ToString();
                strSQL = @"INSERT INTO Inf_Score(
                                    ID,
									KBID,
									UserID,
									UserName,
									Score,
									RegTime
					)
					VALUES( " +
                            strNextID + "," +
                            pInf_ScoreDP.KBID.ToString() + "," +
                            pInf_ScoreDP.UserID.ToString() + "," +
                            StringTool.SqlQ(pInf_ScoreDP.UserName) + "," +
                            pInf_ScoreDP.Score.ToString() + "," +
                            "to_date(" + StringTool.SqlQ(pInf_ScoreDP.RegTime.ToString()) + ",'yyyy-MM-dd HH24:mi:ss')"+
                    ")";

                OracleDbHelper.ExecuteNonQuery(cn, CommandType.Text, strSQL);
            }
            catch
            {
                throw;
            }
            finally
            {
                ConfigTool.CloseConnection(cn);
            }
        }
        #endregion

        #region UpdateRecorded
        /// <summary>
        /// 
        /// </summary>
        /// <param name=pInf_ScoreDP></param>
        public void UpdateRecorded(Inf_ScoreDP pInf_ScoreDP)
        {
            OracleConnection cn = ConfigTool.GetConnection();
            string strSQL = string.Empty;
            try
            {
                strSQL = @"UPDATE Inf_Score Set " +
                            " KBID = " + pInf_ScoreDP.KBID.ToString() + "," +
                            " UserID = " + pInf_ScoreDP.UserID.ToString() + "," +
                            " UserName = " + StringTool.SqlQ(pInf_ScoreDP.UserName) + "," +
                            " Score = " + pInf_ScoreDP.Score.ToString() + "," +
                            " RegTime = to_date(" + StringTool.SqlQ(pInf_ScoreDP.RegTime.ToString()) + ",'yyyy-MM-dd HH24:mi:ss')" +
                                " WHERE ID = " + pInf_ScoreDP.ID.ToString();

                OracleDbHelper.ExecuteNonQuery(cn, CommandType.Text, strSQL);
            }
            catch
            {
                throw;
            }
            finally
            {
                ConfigTool.CloseConnection(cn);
            }
        }
        #endregion

        #region DeleteRecorded
        /// <summary>
        /// 
        /// </summary>
        /// <param name="lngID"></param>
        public void DeleteRecorded(long lngID)
        {
            OracleConnection cn = ConfigTool.GetConnection();
            try
            {
                string strSQL = "delete Inf_Score WHERE ID =" + lngID.ToString();
                OracleDbHelper.ExecuteNonQuery(cn, CommandType.Text, strSQL);
            }
            catch
            {
                throw;
            }
            finally
            {
                ConfigTool.CloseConnection(cn);
            }
        }
        #endregion
    }
}

